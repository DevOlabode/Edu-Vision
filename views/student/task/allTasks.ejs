<% layout('layout/boilerplate') %>

<div class="container mt-5">
  <div class="row">
    <div class="col-12">
      <h1 class="mb-4 text-center" style="color: #667eea; font-weight: 700;">All Tasks</h1>

      <% if (tasks && tasks.length > 0) { %>
        <div class="row">
          <% tasks.forEach(task => { %>
            <div class="col-md-6 col-lg-4 mb-4">
              <div class="card h-100 shadow-sm" style="border-radius: 15px; border: none; background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);">
                <div class="card-body d-flex flex-column">
                  <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="card-title" style="color: #2c3e50; font-weight: 600;"><%= task.title %></h5>
                    <span class="badge <%= task.priority === 'high' ? 'bg-danger' : task.priority === 'medium' ? 'bg-warning' : 'bg-success' %> text-white">
                      <%= task.priority %>
                    </span>
                  </div>

                  <p class="card-text text-muted mb-2"><strong>Subject:</strong> <%= task.subject %></p>
                  <p class="card-text text-muted mb-2"><strong>Type:</strong> <%= task.type %></p>
                  <p class="card-text text-muted mb-2"><strong>Due Date:</strong> <%= new Date(task.dueDate).toLocaleDateString() %></p>
                  <p class="card-text text-muted mb-2"><strong>Status:</strong>
                    <span class="badge <%= task.status === 'completed' ? 'bg-success' : task.status === 'in-progress' ? 'bg-primary' : task.status === 'overdue' ? 'bg-danger' : 'bg-secondary' %> text-white">
                      <%= task.status %>
                    </span>
                  </p>
                  <p class="card-text text-muted mb-2"><strong>Difficulty:</strong> <%= task.difficulty %></p>

                  <% if (task.description) { %>
                    <p class="card-text mb-3"><strong>Description:</strong> <%= task.description %></p>
                  <% } %>

                  <% if (task.milestones && task.milestones.length > 0) { %>
                    <div class="mb-3">
                      <strong>Milestones:</strong>
                      <ul class="list-unstyled">
                        <% task.milestones.forEach(milestone => { %>
                          <li class="d-flex align-items-center">
                            <i class="fas <%= milestone.completed ? 'fa-check-circle text-success' : 'fa-circle text-muted' %> me-2"></i>
                            <%= milestone.title %> - <%= new Date(milestone.dueDate).toLocaleDateString() %>
                          </li>
                        <% }); %>
                      </ul>
                    </div>
                  <% } %>

                  <div class="mt-auto d-flex justify-content-between align-items-center">
                    <small class="text-muted">Created: <%= new Date(task.createdAt).toLocaleDateString() %></small>
                    <a href="/task/<%= task._id %>" class="btn btn-outline-primary btn-sm" style="border-radius: 20px;">
                      <i class="fas fa-eye me-1"></i>View
                    </a>
                  </div>
                </div>
              </div>
            </div>
          <% }); %>
        </div>
      <% } else { %>
        <div class="text-center mt-5">
          <i class="fas fa-tasks fa-4x text-muted mb-3"></i>
          <h3 class="text-muted">No tasks found</h3>
          <p class="text-muted">You haven't added any tasks yet. Start by creating your first task!</p>
          <a href="/task/new" class="btn btn-primary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 25px; padding: 10px 30px;">
            <i class="fas fa-plus me-2"></i>Add New Task
          </a>
        </div>
      <% } %>
    </div>
  </div>
</div>

<style>
.card:hover {
  transform: translateY(-5px);
  transition: transform 0.3s ease;
  box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2) !important;
}

.badge {
  font-size: 0.75rem;
}
</style>
