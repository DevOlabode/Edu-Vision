<% layout('layout/boilerplate.ejs') %>

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <!-- Success Header -->
      <div class="success-header text-center mb-5">
        <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); border-radius: 25px; padding: 50px 30px; color: white; box-shadow: 0 20px 40px rgba(40, 167, 69, 0.3); position: relative; overflow: hidden;">
          <div style="position: absolute; top: -20px; right: -20px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
          <div style="position: absolute; bottom: -30px; left: -30px; width: 150px; height: 150px; background: rgba(255,255,255,0.05); border-radius: 50%;"></div>
          <div style="font-size: 5rem; margin-bottom: 20px; animation: bounce 1s ease-in-out;">
            <i class="fas fa-check-circle"></i>
          </div>
          <h1 style="font-weight: 700; font-size: 3rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); margin-bottom: 10px;">
            Upload Successful!
          </h1>
          <p style="font-size: 1.3rem; opacity: 0.9; margin-bottom: 0;">
            Your document has been added to your AI-powered study library
          </p>
        </div>
      </div>

      <div class="row">
        <!-- File Details Card -->
        <div class="col-lg-8">
          <div class="details-card" style="background: linear-gradient(145deg, #ffffff 0%, #f8fff8 100%); border-radius: 20px; box-shadow: 0 10px 30px rgba(40, 167, 69, 0.15); overflow: hidden; border: 1px solid rgba(40, 167, 69, 0.1);">
            <div class="details-card-header" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); padding: 25px 30px; color: white;">
              <h4 class="mb-0" style="font-weight: 700; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">
                <i class="fas fa-file-alt me-2"></i>Document Details
              </h4>
            </div>
            <div class="details-card-body" style="padding: 35px;">
              <div class="file-info-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px;">
                <!-- Title -->
                <div class="info-item" style="background: linear-gradient(135deg, rgba(40, 167, 69, 0.05) 0%, rgba(32, 201, 151, 0.03) 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #28a745;">
                  <div class="d-flex align-items-center mb-2">
                    <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);">
                      <i class="fas fa-heading" style="font-size: 16px;"></i>
                    </div>
                    <small style="color: #6c757d; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 11px;">Title</small>
                  </div>
                  <div style="font-weight: 700; color: #2c3e50; font-size: 16px;"><%= material.title %></div>
                </div>

                <!-- File Name -->
                <div class="info-item" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.03) 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #667eea;">
                  <div class="d-flex align-items-center mb-2">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                      <i class="fas fa-file-signature" style="font-size: 16px;"></i>
                    </div>
                    <small style="color: #6c757d; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 11px;">File Name</small>
                  </div>
                  <div style="font-weight: 700; color: #2c3e50; font-size: 16px;"><%= material.fileName %></div>
                </div>

                <!-- File Type -->
                <div class="info-item" style="background: linear-gradient(135deg, rgba(240, 147, 251, 0.05) 0%, rgba(245, 87, 108, 0.03) 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #f093fb;">
                  <div class="d-flex align-items-center mb-2">
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 4px 12px rgba(240, 147, 251, 0.3);">
                      <i class="fas fa-file-<%= material.fileType === 'pdf' ? 'pdf' : material.fileType === 'docx' ? 'word' : 'alt' %>" style="font-size: 16px;"></i>
                    </div>
                    <small style="color: #6c757d; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 11px;">File Type</small>
                  </div>
                  <div style="font-weight: 700; color: #2c3e50; font-size: 16px;"><%= material.fileType.toUpperCase() %></div>
                </div>

                <!-- File Size -->
                <div class="info-item" style="background: linear-gradient(135deg, rgba(255, 193, 7, 0.05) 0%, rgba(253, 126, 20, 0.03) 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #ffc107;">
                  <div class="d-flex align-items-center mb-2">
                    <div style="background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);">
                      <i class="fas fa-weight-hanging" style="font-size: 16px;"></i>
                    </div>
                    <small style="color: #6c757d; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 11px;">File Size</small>
                  </div>
                  <div style="font-weight: 700; color: #2c3e50; font-size: 16px;"><%= (material.fileSize / 1024).toFixed(2) %> KB</div>
                </div>

                <!-- Status -->
                <div class="info-item" style="background: linear-gradient(135deg, <%= material.status === 'ready' ? 'rgba(40, 167, 69, 0.05)' : material.status === 'processing' ? 'rgba(255, 193, 7, 0.05)' : 'rgba(220, 53, 69, 0.05)' %> 0%, <%= material.status === 'ready' ? 'rgba(32, 201, 151, 0.03)' : material.status === 'processing' ? 'rgba(253, 126, 20, 0.03)' : 'rgba(232, 62, 140, 0.03)' %> 100%); border-radius: 12px; padding: 20px; border-left: 4px solid <%= material.status === 'ready' ? '#28a745' : material.status === 'processing' ? '#ffc107' : '#dc3545' %>;">
                  <div class="d-flex align-items-center mb-2">
                    <div style="background: linear-gradient(135deg, <%= material.status === 'ready' ? '#28a745 0%, #20c997 100%' : material.status === 'processing' ? '#ffc107 0%, #fd7e14 100%' : '#dc3545 0%, #e83e8c 100%' %>); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 4px 12px <%= material.status === 'ready' ? 'rgba(40, 167, 69, 0.3)' : material.status === 'processing' ? 'rgba(255, 193, 7, 0.3)' : 'rgba(220, 53, 69, 0.3)' %>;">
                      <i class="fas fa-<%= material.status === 'ready' ? 'check-circle' : material.status === 'processing' ? 'clock' : 'exclamation-triangle' %>" style="font-size: 16px;"></i>
                    </div>
                    <small style="color: #6c757d; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 11px;">Status</small>
                  </div>
                  <div style="font-weight: 700; color: #2c3e50; font-size: 16px; text-transform: capitalize;"><%= material.status %></div>
                </div>

                <!-- Upload Date -->
                <div class="info-item" style="background: linear-gradient(135deg, rgba(108, 117, 125, 0.05) 0%, rgba(73, 80, 87, 0.03) 100%); border-radius: 12px; padding: 20px; border-left: 4px solid #6c757d;">
                  <div class="d-flex align-items-center mb-2">
                    <div style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px; box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);">
                      <i class="fas fa-calendar-alt" style="font-size: 16px;"></i>
                    </div>
                    <small style="color: #6c757d; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; font-size: 11px;">Uploaded</small>
                  </div>
                  <div style="font-weight: 700; color: #2c3e50; font-size: 16px;"><%= new Date(material.createdAt).toLocaleString() %></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Actions Sidebar -->
        <div class="col-lg-4">
          <div class="actions-sidebar">
            <!-- Next Steps -->
            <div class="action-card mb-4" style="background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%); border-radius: 15px; padding: 25px; box-shadow: 0 6px 20px rgba(102, 126, 234, 0.1); border: 1px solid rgba(102, 126, 234, 0.1);">
              <h6 style="color: #2c3e50; font-weight: 700; margin-bottom: 20px;">
                <i class="fas fa-forward me-2" style="color: #667eea;"></i>What Happens Next?
              </h6>
              <div class="next-steps">
                <% if (material.status === 'ready') { %>
                  <div class="step completed d-flex align-items-center mb-3" style="color: #28a745;">
                    <i class="fas fa-check-circle me-3" style="font-size: 1.2rem;"></i>
                    <span style="font-weight: 600;">AI Processing Complete</span>
                  </div>
                  <div class="step completed d-flex align-items-center mb-3" style="color: #28a745;">
                    <i class="fas fa-check-circle me-3" style="font-size: 1.2rem;"></i>
                    <span style="font-weight: 600;">Study Materials Ready</span>
                  </div>
                <% } else if (material.status === 'processing') { %>
                  <div class="step processing d-flex align-items-center mb-3" style="color: #ffc107;">
                    <i class="fas fa-clock me-3" style="font-size: 1.2rem;"></i>
                    <span style="font-weight: 600;">AI Processing Document...</span>
                  </div>
                  <div class="step pending d-flex align-items-center mb-3" style="color: #6c757d;">
                    <i class="fas fa-circle me-3" style="font-size: 1.2rem;"></i>
                    <span>Generating Summaries</span>
                  </div>
                  <div class="step pending d-flex align-items-center mb-3" style="color: #6c757d;">
                    <i class="fas fa-circle me-3" style="font-size: 1.2rem;"></i>
                    <span>Creating Flashcards</span>
                  </div>
                <% } else { %>
                  <div class="step error d-flex align-items-center mb-3" style="color: #dc3545;">
                    <i class="fas fa-exclamation-triangle me-3" style="font-size: 1.2rem;"></i>
                    <span style="font-weight: 600;">Processing Error</span>
                  </div>
                <% } %>
              </div>
            </div>

            <!-- Quick Actions -->
            <div class="action-card mb-4" style="background: linear-gradient(145deg, #ffffff 0%, #f8fff8 100%); border-radius: 15px; padding: 25px; box-shadow: 0 6px 20px rgba(40, 167, 69, 0.1); border: 1px solid rgba(40, 167, 69, 0.1);">
              <h6 style="color: #2c3e50; font-weight: 700; margin-bottom: 20px;">
                <i class="fas fa-rocket me-2" style="color: #28a745;"></i>Quick Actions
              </h6>
              <div class="quick-actions d-grid gap-3">
                <% if (material.status === 'ready') { %>
                  <a href="/materials/<%= material._id %>" class="btn btn-primary btn-lg" style="border-radius: 25px; font-weight: 600; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
                    <i class="fas fa-eye me-2"></i>View Study Materials
                  </a>
                <% } %>
                <a href="/upload" class="btn btn-outline-primary btn-lg" style="border-radius: 25px; font-weight: 600; border: 2px solid #667eea;">
                  <i class="fas fa-plus me-2"></i>Upload Another File
                </a>
                <a href="/materials" class="btn btn-outline-secondary btn-lg" style="border-radius: 25px; font-weight: 600;">
                  <i class="fas fa-list me-2"></i>View All Materials
                </a>
                <a href="/" class="btn btn-outline-info btn-lg" style="border-radius: 25px; font-weight: 600;">
                  <i class="fas fa-home me-2"></i>Back to Home
                </a>
              </div>
            </div>

            <!-- Content Preview (if ready) -->
            <% if (material.status === 'ready') { %>
              <div class="preview-card" style="background: linear-gradient(145deg, #ffffff 0%, #fefefe 100%); border-radius: 15px; padding: 25px; box-shadow: 0 6px 20px rgba(0,0,0,0.05); border: 1px solid rgba(0,0,0,0.05);">
                <h6 style="color: #2c3e50; font-weight: 700; margin-bottom: 15px;">
                  <i class="fas fa-search me-2" style="color: #6c757d;"></i>Content Preview
                </h6>
                <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; max-height: 150px; overflow-y: auto; border: 1px solid #e9ecef;">
                  <% if (material.content) { %>
                    <p style="margin-bottom: 0; font-size: 0.9rem; color: #495057; line-height: 1.5;"><%= material.content.substring(0, 300) %>...</p>
                  <% } else { %>
                    <p style="margin-bottom: 0; font-size: 0.9rem; color: #6c757d; font-style: italic;">Content preview not available</p>
                  <% } %>
                </div>
              </div>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-10px);
  }
  60% {
    transform: translateY(-5px);
  }
}
</style>
